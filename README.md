# ğŸ¤– ArtifactFlow

> Multi-Agent System based on LangGraph and Artifacts

[![Python 3.11+](https://img.shields.io/badge/python-3.11+-blue.svg)](https://www.python.org/downloads/)
[![LangGraph](https://img.shields.io/badge/LangGraph-Latest-green.svg)](https://github.com/langchain-ai/langgraph)
[![SQLite](https://img.shields.io/badge/SQLite-Persistent-blue.svg)]()
[![Development Status](https://img.shields.io/badge/Status-Alpha%20Development-orange.svg)]()

ArtifactFlow æ˜¯ä¸€ä¸ªæ™ºèƒ½å¤šæ™ºèƒ½ä½“ç ”ç©¶ç³»ç»Ÿï¼Œé€šè¿‡åè°ƒä¸“é—¨çš„AIæ™ºèƒ½ä½“æ¥æ‰§è¡Œç»¼åˆæ€§ç ”ç©¶ä»»åŠ¡ã€‚åŸºäº LangGraph æ„å»ºï¼Œé‡‡ç”¨ç‹¬ç‰¹çš„åŒ Artifact æ¶æ„ï¼Œå®ç° AI åä½œç ”ç©¶å’Œäººå·¥ç›‘ç£çš„è¿­ä»£ä¼˜åŒ–ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ğŸ—‚ï¸ åŒArtifactæ¶æ„**: ä»»åŠ¡è®¡åˆ’ä¸ç»“æœå·¥ä»¶åˆ†ç¦»ï¼Œæ”¯æŒç‰ˆæœ¬è¿½æº¯
- **ğŸ¤ å¤šæ™ºèƒ½ä½“åä½œ**: Lead/Search/Crawl ä¸“ä¸šåˆ†å·¥ï¼ŒLangGraph ç¼–æ’
- **âš¡ æµå¼å“åº”**: å®æ—¶è¾“å‡ºæ€è€ƒè¿‡ç¨‹å’Œå·¥å…·è°ƒç”¨ï¼ŒSSE æ¨é€
- **ğŸ”§ æƒé™æ§åˆ¶**: å·¥å…·åˆ†çº§æƒé™ï¼Œæ”¯æŒä¸­æ–­ç¡®è®¤åæ¢å¤æ‰§è¡Œ
- **ğŸŒ³ åˆ†æ”¯å¯¹è¯**: ä»ä»»æ„å†å²èŠ‚ç‚¹åˆ›å»ºæ–°åˆ†æ”¯
- **ğŸ’¾ æŒä¹…åŒ–å­˜å‚¨**: SQLite + ä¹è§‚é”ï¼ŒæœåŠ¡é‡å¯æ•°æ®ä¸ä¸¢å¤±
- **ğŸŒ REST API**: FastAPI æ¥å£ï¼Œæ”¯æŒå‰ç«¯é›†æˆ

## ğŸ› ï¸ ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        API Layer                            â”‚
â”‚      (FastAPI, SSE Stream, Routers, StreamManager)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Application Layer                       â”‚
â”‚           (ExecutionController, Agents, Tools)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Manager Layer                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚ ConversationManager â”‚   â”‚    ArtifactManager      â”‚     â”‚
â”‚   â”‚  - In-memory cache  â”‚   â”‚  - In-memory cache      â”‚     â”‚
â”‚   â”‚  - Call Repository  â”‚   â”‚  - Call Repository      â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Repository Layer                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ConversationRepositoryâ”‚   â”‚   ArtifactRepository    â”‚    â”‚
â”‚   â”‚  - CRUD operations   â”‚   â”‚  - CRUD operations      â”‚    â”‚
â”‚   â”‚  - Tree queries      â”‚   â”‚  - Version & Opt. Lock  â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Database Layer                         â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â–¼                         â–¼                    â”‚
â”‚     App DB (SQLite)          LangGraph Checkpointer         â”‚
â”‚     (conversations,          (AsyncSqliteSaver)             â”‚
â”‚      messages, artifacts)    (thread states)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Artifact å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       ARTIFACT LAYER                       â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚       Task Plan Artifact      â”‚  â”‚    Result Artifact â”‚ â”‚
â”‚  â”‚  - Task breakdown & tracking  â”‚  â”‚  - Final outputs   â”‚ â”‚
â”‚  â”‚  - Shared context for agents  â”‚  â”‚  - User editable   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†‘                     â†‘                    â†‘
    Lead Agent              Subagents                User
  (Read/Write)             (Read Only)           (Read/Edit)
```

### æ™ºèƒ½ä½“è§’è‰²

- **ğŸ¯ ä¸»æ§æ™ºèƒ½ä½“ (Lead Agent)**: ä»»åŠ¡åè°ƒã€ä¿¡æ¯æ•´åˆã€ç”¨æˆ·äº¤äº’
- **ğŸ” æœç´¢æ™ºèƒ½ä½“ (Search Agent)**: ä¿¡æ¯æ£€ç´¢å’Œç»“æ„åŒ–æœç´¢ç»“æœ
- **ğŸ•·ï¸ ç½‘é¡µæŠ“å–æ™ºèƒ½ä½“ (Crawl Agent)**: æ·±åº¦å†…å®¹æå–å’Œåˆ†æï¼ˆæ”¯æŒHTMLå’ŒPDFï¼‰

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Python 3.11+** ï¼ˆâš ï¸å¿…éœ€ï¼LangGraphçš„å¼‚æ­¥interruptåŠŸèƒ½éœ€è¦Python 3.11+æ‰èƒ½æ­£ç¡®å·¥ä½œï¼Œè¯¦è§ï¼š [Asynchronous Graph with interrupts in Python 3.10 seems to be broken](https://github.com/langchain-ai/langgraph/discussions/3200)ï¼‰
- API Keysï¼ˆOpenAIã€é€šä¹‰åƒé—®ã€DeepSeekã€åšæŸ¥AI ç­‰ï¼‰
- æ¨èç³»ç»Ÿå†…å­˜ â‰¥ 4GBï¼ˆç½‘é¡µæŠ“å–éœ€è¦å¯åŠ¨æµè§ˆå™¨ï¼‰
- **âš ï¸ ä¾èµ–ç‰ˆæœ¬æ³¨æ„**: `aiosqlite` å¿…é¡»ä½¿ç”¨ **0.21.0** ç‰ˆæœ¬ã€‚0.22.0 ç‰ˆæœ¬ç§»é™¤äº† `Connection` å¯¹ `threading.Thread` çš„ç»§æ‰¿ï¼Œå¯¼è‡´ `is_alive()` æ–¹æ³•ä¸¢å¤±ï¼Œä¸ `langgraph-checkpoint-sqlite` ä¸å…¼å®¹ã€‚requirements.txt å·²é”å®šæ­£ç¡®ç‰ˆæœ¬ã€‚

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/yourusername/artifact-flow.git
   cd artifact-flow
   ```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**
   ```bash
   # ä½¿ç”¨ condaï¼ˆæ¨èï¼‰
   conda create -n artifact-flow python=3.11
   conda activate artifact-flow
   
   # æˆ–ä½¿ç”¨ venv
   python3.11 -m venv artifact-flow
   # Windows: artifact-flow\Scripts\activate
   # macOS/Linux: source artifact-flow/bin/activate
   ```

3. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r requirements.txt
   pip install -e .
   ```

4. **âš ï¸ é‡è¦ï¼šåˆå§‹åŒ–crawl4ai**
   ```bash
   # crawl4ai éœ€è¦é¢å¤–çš„åˆå§‹åŒ–æ­¥éª¤
   crawl4ai-setup
   ```
   
   è¿™ä¸ªå‘½ä»¤ä¼šï¼š
   - ä¸‹è½½å¿…è¦çš„æµè§ˆå™¨é©±åŠ¨ç¨‹åº
   - é…ç½®Playwrightç¯å¢ƒ

5. **é…ç½®ç¯å¢ƒå˜é‡**
   ```bash
   cp .env.example .env
   # ç¼–è¾‘ .env æ–‡ä»¶ï¼Œæ·»åŠ ä½ çš„ API Keys
   ```

6. **å¯åŠ¨æœåŠ¡**
   ```bash
   # å¯åŠ¨ API æœåŠ¡å™¨
   python run_server.py

   # å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰
   python run_server.py --reload

   # æœåŠ¡å¯åŠ¨åè®¿é—®:
   # - API æ–‡æ¡£: http://localhost:8000/docs
   # - ReDoc æ–‡æ¡£: http://localhost:8000/redoc
   ```

7. **ä½¿ç”¨ CLI äº¤äº’**
   ```bash
   # è¿›å…¥äº¤äº’å¼èŠå¤©ï¼ˆéœ€å…ˆå¯åŠ¨æœåŠ¡å™¨ï¼‰
   python run_cli.py chat

   # æˆ–ç›´æ¥å‘é€æ¶ˆæ¯
   python run_cli.py chat "ç ”ç©¶ä¸€ä¸‹ LangGraph çš„æœ€æ–°ç‰¹æ€§"
   ```

## ğŸ”‘ é…ç½®æŒ‡å—

åˆ›å»º `.env` æ–‡ä»¶å¹¶é…ç½®ä»¥ä¸‹ API Keysï¼š

```env
# ========================================
# æ¨¡å‹ API é…ç½®
# ========================================

# ------ OpenAI (GPTç³»åˆ—) ------
# è·å–åœ°å€: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-xxx

# ------ é€šä¹‰åƒé—® (Qwen) ------
# è·å–åœ°å€: https://dashscope.console.aliyun.com/apiKey
DASHSCOPE_API_KEY=sk-xxx

# ------ DeepSeek ------
# è·å–åœ°å€: https://platform.deepseek.com/api_keys
DEEPSEEK_API_KEY=sk-xxx

# ========================================
# å·¥å…· API é…ç½®
# ========================================

# ------ åšæŸ¥AI (Webæœç´¢) ------
# è·å–åœ°å€: https://open.bochaai.com
BOCHA_API_KEY=sk-xxx
```

## ğŸ’¡ æ”¯æŒçš„æ¨¡å‹

### OpenAI
- `gpt-4o` - æœ€æ–°çš„ GPT-4 æ¨¡å‹
- `gpt-4o-mini` - è½»é‡çº§ç‰ˆæœ¬

### é€šä¹‰åƒé—® (Qwen)
- `qwen-flash` - å¿«é€Ÿå“åº”ç‰ˆæœ¬
- `qwen-plus` - å¢å¼ºç‰ˆæœ¬
- `qwen3-30b-thinking` - æ”¯æŒæ·±åº¦æ¨ç†çš„æ€è€ƒæ¨¡å‹ â­
- `qwen3-30b-instruct` - å¿«é€ŸæŒ‡ä»¤å“åº”æ¨¡å‹
- `qwen3-next-80b-thinking` - æ›´å¤§è§„æ¨¡çš„æ€è€ƒæ¨¡å‹
- `qwen3-next-80b-instruct` - æ›´å¤§è§„æ¨¡çš„æŒ‡ä»¤æ¨¡å‹

### DeepSeek
- `deepseek-chat` - å¯¹è¯æ¨¡å‹
- `deepseek-reasoner` - æ¨ç†æ¨¡å‹ â­

## ğŸ’¾ æ•°æ®æŒä¹…åŒ–

ArtifactFlow ä½¿ç”¨ SQLite æ•°æ®åº“è¿›è¡Œæ•°æ®æŒä¹…åŒ–ï¼Œé‡‡ç”¨åŒå±‚å­˜å‚¨æ¶æ„ï¼š

### å­˜å‚¨ä½ç½®

```
data/
â””â”€â”€ artifactflow.db    # SQLite æ•°æ®åº“æ–‡ä»¶ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
```

### æ•°æ®åº“è¡¨ç»“æ„

| è¡¨å | è¯´æ˜ |
|------|------|
| `conversations` | å¯¹è¯å…ƒä¿¡æ¯ï¼ˆIDã€æ ‡é¢˜ã€æ´»è·ƒåˆ†æ”¯ã€æ—¶é—´æˆ³ï¼‰ |
| `messages` | æ¶ˆæ¯è®°å½•ï¼ˆæ ‘ç»“æ„ï¼Œæ”¯æŒåˆ†æ”¯å¯¹è¯ï¼‰ |
| `artifact_sessions` | Artifact ä¼šè¯ï¼ˆä¸å¯¹è¯ 1:1 å…³è”ï¼‰ |
| `artifacts` | Artifact å†…å®¹ï¼ˆå«ä¹è§‚é”ç‰ˆæœ¬æ§åˆ¶ï¼‰ |
| `artifact_versions` | Artifact å†å²ç‰ˆæœ¬ï¼ˆæ”¯æŒç‰ˆæœ¬å›æº¯ï¼‰ |

### ç‰¹æ€§

- **WAL æ¨¡å¼**: å¯ç”¨ Write-Ahead Loggingï¼Œæ”¯æŒå¹¶å‘è¯»å†™
- **ä¹è§‚é”**: Artifact æ›´æ–°ä½¿ç”¨ä¹è§‚é”æœºåˆ¶ï¼Œé˜²æ­¢å¹¶å‘å†²çª
- **çƒ­æ•°æ®ç¼“å­˜**: Manager å±‚å®ç° LRU ç¼“å­˜ï¼Œå‡å°‘æ•°æ®åº“è®¿é—®
- **PostgreSQL å…¼å®¹**: ä½¿ç”¨ SQLAlchemy ORMï¼Œå¯å¹³æ»‘è¿ç§»åˆ° PostgreSQL

### åˆå§‹åŒ–

æ•°æ®åº“åœ¨é¦–æ¬¡è¿è¡Œæ—¶è‡ªåŠ¨åˆ›å»ºï¼Œæ— éœ€æ‰‹åŠ¨åˆå§‹åŒ–ã€‚å¦‚éœ€é‡ç½®æ•°æ®åº“ï¼š

```bash
# åˆ é™¤æ•°æ®åº“æ–‡ä»¶ï¼ˆè°¨æ…æ“ä½œï¼Œå°†ä¸¢å¤±æ‰€æœ‰æ•°æ®ï¼‰
rm data/artifactflow.db
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
artifact-flow/
â”œâ”€â”€ run_server.py       # API æœåŠ¡å™¨å¯åŠ¨è„šæœ¬
â”œâ”€â”€ run_cli.py          # CLI å¯åŠ¨è„šæœ¬
â”œâ”€â”€ cli/                # CLI å‘½ä»¤è¡Œå·¥å…· (Typer + Rich)
â”‚   â”œâ”€â”€ main.py                  # CLI ä¸»å…¥å£å’Œå‘½ä»¤å®šä¹‰
â”‚   â”œâ”€â”€ api_client.py            # API å®¢æˆ·ç«¯å°è£…
â”‚   â”œâ”€â”€ config.py                # CLI é…ç½®å’ŒçŠ¶æ€ç®¡ç†
â”‚   â””â”€â”€ ui.py                    # Rich ç»ˆç«¯ UI ç»„ä»¶
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/ âœ…        # æ ¸å¿ƒå·¥ä½œæµå’ŒçŠ¶æ€ç®¡ç† (å·²å®Œæˆ)
â”‚   â”‚   â”œâ”€â”€ state.py              # çŠ¶æ€ç®¡ç†å’Œå®šä¹‰
â”‚   â”‚   â”œâ”€â”€ graph.py              # LangGraphå·¥ä½œæµå®šä¹‰
â”‚   â”‚   â”œâ”€â”€ controller.py         # æ‰§è¡Œæ§åˆ¶å™¨ (æ”¯æŒæµå¼å’Œæ‰¹é‡æ¨¡å¼)
â”‚   â”‚   â”œâ”€â”€ events.py             # ç»Ÿä¸€äº‹ä»¶ç±»å‹å’ŒExecutionMetricså®šä¹‰
â”‚   â”‚   â”œâ”€â”€ context_manager.py    # Contextå‹ç¼©å’Œç®¡ç†
â”‚   â”‚   â””â”€â”€ conversation_manager.py  # å¯¹è¯ç®¡ç†å™¨ï¼ˆç¼“å­˜+æŒä¹…åŒ–ï¼‰
â”‚   â”œâ”€â”€ agents/ âœ…      # æ™ºèƒ½ä½“å®ç° (å·²å®Œæˆ)
â”‚   â”‚   â”œâ”€â”€ base.py               # AgentåŸºç±»å’Œæµå¼æ‰§è¡Œæ¡†æ¶
â”‚   â”‚   â”œâ”€â”€ lead_agent.py         # ä¸»æ§æ™ºèƒ½ä½“å®ç°
â”‚   â”‚   â”œâ”€â”€ search_agent.py       # æœç´¢æ™ºèƒ½ä½“å®ç°
â”‚   â”‚   â””â”€â”€ crawl_agent.py        # ç½‘é¡µæŠ“å–æ™ºèƒ½ä½“å®ç°
â”‚   â”œâ”€â”€ tools/ âœ…       # å·¥å…·ç³»ç»Ÿå’Œå®ç° (å·²å®Œæˆ)
â”‚   â”‚   â”œâ”€â”€ base.py               # å·¥å…·åŸºç±»å’Œæƒé™å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ registry.py           # å·¥å…·æ³¨å†Œå’Œç®¡ç†
â”‚   â”‚   â”œâ”€â”€ permissions.py        # æƒé™æ§åˆ¶ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ prompt_generator.py   # XMLæç¤ºè¯ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ implementations/      # å…·ä½“å·¥å…·å®ç°
â”‚   â”‚       â”œâ”€â”€ artifact_ops.py   # Artifactæ“ä½œå·¥å…· (ArtifactManager)
â”‚   â”‚       â”œâ”€â”€ web_search.py     # åšæŸ¥AIæœç´¢
â”‚   â”‚       â”œâ”€â”€ web_fetch.py      # crawl4aiç½‘é¡µæŠ“å–(æ”¯æŒPDF)
â”‚   â”‚       â””â”€â”€ call_subagent.py  # Subagentè°ƒç”¨å·¥å…·
â”‚   â”œâ”€â”€ db/ âœ…          # æ•°æ®åº“å±‚ (å·²å®Œæˆ)
â”‚   â”‚   â”œâ”€â”€ database.py           # DatabaseManagerï¼šè¿æ¥æ± ã€WALæ¨¡å¼
â”‚   â”‚   â”œâ”€â”€ models.py             # SQLAlchemy ORM æ¨¡å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ migrations/           # æ•°æ®åº“è¿ç§»è„šæœ¬
â”‚   â”‚       â””â”€â”€ versions/
â”‚   â”‚           â””â”€â”€ 001_initial_schema.py
â”‚   â”œâ”€â”€ repositories/ âœ… # æ•°æ®è®¿é—®å±‚ (å·²å®Œæˆ)
â”‚   â”‚   â”œâ”€â”€ base.py               # BaseRepository æŠ½è±¡ç±»
â”‚   â”‚   â”œâ”€â”€ conversation_repo.py  # ConversationRepository
â”‚   â”‚   â””â”€â”€ artifact_repo.py      # ArtifactRepository (å«ä¹è§‚é”)
â”‚   â”œâ”€â”€ models/ âœ…      # LLM æ¥å£å°è£… (å·²å®Œæˆ)
â”‚   â”‚   â””â”€â”€ llm.py                # ç»Ÿä¸€çš„å¤šæ¨¡å‹æ¥å£
â”‚   â”œâ”€â”€ utils/ âœ…       # å·¥å…·å‡½æ•°å’Œå¸®åŠ©ç±» (å·²å®Œæˆ)
â”‚   â”‚   â”œâ”€â”€ logger.py             # åˆ†çº§æ—¥å¿—ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ retry.py              # æŒ‡æ•°é€€é¿é‡è¯•
â”‚   â”‚   â””â”€â”€ xml_parser.py         # é²æ£’XMLè§£æ
â”‚   â””â”€â”€ api/ âœ…         # API æ¥å£å±‚ (å·²å®Œæˆ)
â”‚       â”œâ”€â”€ main.py               # FastAPI åº”ç”¨å…¥å£
â”‚       â”œâ”€â”€ config.py             # API é…ç½®ï¼ˆCORSã€SSEã€åˆ†é¡µç­‰ï¼‰
â”‚       â”œâ”€â”€ dependencies.py       # ä¾èµ–æ³¨å…¥ï¼ˆControllerã€Managerç­‰ï¼‰
â”‚       â”œâ”€â”€ routers/              # è·¯ç”±æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ chat.py           # /api/v1/chat å¯¹è¯æ¥å£
â”‚       â”‚   â”œâ”€â”€ artifacts.py      # /api/v1/artifacts Artifactæ¥å£
â”‚       â”‚   â””â”€â”€ stream.py         # /api/v1/stream SSEæµå¼æ¥å£
â”‚       â”œâ”€â”€ schemas/              # Pydantic æ¨¡å‹
â”‚       â”‚   â”œâ”€â”€ chat.py           # å¯¹è¯ç›¸å…³ schema
â”‚       â”‚   â”œâ”€â”€ artifact.py       # Artifact ç›¸å…³ schema
â”‚       â”‚   â””â”€â”€ events.py         # SSE äº‹ä»¶ schema
â”‚       â”œâ”€â”€ services/             # æœåŠ¡å±‚
â”‚       â”‚   â””â”€â”€ stream_manager.py # äº‹ä»¶ç¼“å†²é˜Ÿåˆ—ç®¡ç†
â”‚       â””â”€â”€ utils/
â”‚           â””â”€â”€ sse.py            # SSE å“åº”æ„å»ºå™¨
â”œâ”€â”€ data/               # æ•°æ®ç›®å½• (SQLiteæ•°æ®åº“æ–‡ä»¶)
â”œâ”€â”€ tests/              # æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ core_graph_test.py             # æ‰¹é‡æ¨¡å¼æµ‹è¯•ï¼ˆå¤šè½®å¯¹è¯ã€æƒé™ã€åˆ†æ”¯ï¼‰
â”‚   â”œâ”€â”€ core_graph_test_with_stream.py # æµå¼æ¨¡å¼æµ‹è¯•ï¼ˆå®æ—¶è¾“å‡ºï¼‰
â”‚   â””â”€â”€ api_smoke_test.py              # API çƒŸé›¾æµ‹è¯•
â”œâ”€â”€ prompts/            # æ™ºèƒ½ä½“æç¤ºè¯æ¨¡æ¿
â”œâ”€â”€ examples/           # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ logs/               # æ—¥å¿—ç›®å½•
â””â”€â”€ docs/               # æ–‡æ¡£
```

## ğŸ§ª ä½¿ç”¨æ–¹å¼

### CLI å‘½ä»¤è¡Œå·¥å…·

åŸºäº Typer + Rich çš„ç»ˆç«¯äº¤äº’ç•Œé¢ï¼Œéœ€è¦å…ˆå¯åŠ¨ API æœåŠ¡å™¨ï¼š

```bash
# 1. å¯åŠ¨ API æœåŠ¡å™¨
python run_server.py

# 2. ä½¿ç”¨ CLIï¼ˆå¦å¼€ç»ˆç«¯ï¼‰
python run_cli.py chat              # è¿›å…¥äº¤äº’å¼èŠå¤©
python run_cli.py chat "ä½ å¥½"       # å‘é€å•æ¡æ¶ˆæ¯
python run_cli.py chat -n           # å¼€å§‹æ–°å¯¹è¯
```

#### CLI å®Œæ•´å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `chat [message]` | å‘é€æ¶ˆæ¯ï¼Œæ— å‚æ•°æ—¶è¿›å…¥äº¤äº’æ¨¡å¼ |
| `chat -n/--new` | å¼€å§‹æ–°å¯¹è¯ |
| `list` | åˆ—å‡ºæœ€è¿‘å¯¹è¯ |
| `show <id>` | æŸ¥çœ‹å¯¹è¯è¯¦æƒ… |
| `use <id>` | åˆ‡æ¢åˆ°æŒ‡å®šå¯¹è¯ |
| `artifacts [session_id]` | åˆ—å‡º Artifacts |
| `artifact <id>` | æŸ¥çœ‹ Artifact å†…å®¹ |
| `status` | æ˜¾ç¤ºå½“å‰ CLI çŠ¶æ€ |
| `clear` | æ¸…é™¤ä¼šè¯çŠ¶æ€ |

äº¤äº’æ¨¡å¼å†…ç½®å‘½ä»¤ï¼š
- `/new` - å¼€å§‹æ–°å¯¹è¯
- `/status` - æŸ¥çœ‹å½“å‰çŠ¶æ€
- `quit` / `exit` - é€€å‡º

### æµ‹è¯•è„šæœ¬

`tests/` ç›®å½•ä¸‹æä¾›äº†æ ¸å¿ƒæ¨¡å—çš„æµ‹è¯•è„šæœ¬ï¼š

```bash
# æ‰¹é‡æ¨¡å¼æµ‹è¯• - å¤šè½®å¯¹è¯ã€æƒé™ç¡®è®¤ã€åˆ†æ”¯å¯¹è¯
python -m tests.core_graph_test

# æµå¼æ¨¡å¼æµ‹è¯• - å®æ—¶è¾“å‡ºã€æ€è€ƒè¿‡ç¨‹å±•ç¤º
python -m tests.core_graph_test_with_stream
```

æµ‹è¯•è„šæœ¬æä¾›äº¤äº’å¼èœå•ï¼š
1. **å¤šè½®å¯¹è¯** - æ¼”ç¤ºå¤šè½®ä¸Šä¸‹æ–‡ä¿æŒ
2. **æƒé™ç¡®è®¤** - æ¼”ç¤ºå·¥å…·æƒé™ä¸­æ–­/æ¢å¤æµç¨‹
3. **åˆ†æ”¯å¯¹è¯** - æ¼”ç¤ºä»å†å²æ¶ˆæ¯åˆ›å»ºåˆ†æ”¯
4. **æ‰¹é‡ vs æµå¼å¯¹æ¯”** - å¯¹æ¯”ä¸¤ç§æ‰§è¡Œæ¨¡å¼ï¼ˆä»…æµå¼æµ‹è¯•ï¼‰

## ğŸ“ˆ å¼€å‘è·¯çº¿å›¾

- âœ… **åŸºç¡€è®¾æ–½** (v0.1.0) - **å·²å®Œæˆ**
  - [x] é¡¹ç›®ç»“æ„å’Œé…ç½®
  - [x] æ ¸å¿ƒå·¥å…·æ¨¡å—ï¼ˆæ—¥å¿—ã€é‡è¯•ã€XMLè§£æï¼‰
  - [x] å¤šæ¨¡å‹LLMæ¥å£ç»Ÿä¸€å°è£…

- âœ… **å·¥å…·ç³»ç»Ÿ** (v0.1.5) - **å·²å®Œæˆ**
  - [x] å·¥å…·æ¡†æ¶å’Œæƒé™æ§åˆ¶
  - [x] Artifactæ“ä½œå·¥å…·
  - [x] Webæœç´¢å’ŒæŠ“å–å·¥å…·ï¼ˆæ”¯æŒPDFï¼‰
  - [x] XMLæç¤ºè¯ç”Ÿæˆç³»ç»Ÿ

- âœ… **æ™ºèƒ½ä½“ç³»ç»Ÿ** (v0.2.0) - **å·²å®Œæˆ**
  - [x] BaseAgentæŠ½è±¡ç±»å’Œç»Ÿä¸€æ‰§è¡Œæ¡†æ¶
  - [x] Lead Agent å®ç° - ä»»åŠ¡åè°ƒå’Œä¿¡æ¯æ•´åˆ
  - [x] Search Agent å®ç° - ä¿¡æ¯æ£€ç´¢ä¸“å®¶
  - [x] Crawl Agent å®ç° - ç½‘é¡µå†…å®¹æŠ“å–ä¸“å®¶

- âœ… **å·¥ä½œæµç¼–æ’** (v0.3.0) - **å·²å®Œæˆ**
  - [x] AgentçŠ¶æ€ç®¡ç† (state.py)
  - [x] LangGraphå·¥ä½œæµ (graph.py)
  - [x] æ‰§è¡Œæ§åˆ¶å™¨ (controller.py)
  - [x] Contextå‹ç¼©å’Œç®¡ç† (context_manager.py)
  - [x] å¤šè½®å¯¹è¯æ”¯æŒ
  - [x] åˆ†æ”¯å¯¹è¯åŠŸèƒ½
  - [x] æƒé™ç¡®è®¤æµç¨‹

- âœ… **æ•°æ®æŒä¹…åŒ–** (v0.3.5) - **å·²å®Œæˆ**
  - [x] SQLite + WAL æ¨¡å¼æŒä¹…åŒ–å­˜å‚¨
  - [x] SQLAlchemy ORM æ•°æ®æ¨¡å‹
  - [x] Repository æ¨¡å¼æ•°æ®è®¿é—®å±‚
  - [x] ä¹è§‚é”å¹¶å‘æ§åˆ¶
  - [x] LangGraph Checkpointer çŠ¶æ€æŒä¹…åŒ–
  - [x] ä¾èµ–æ³¨å…¥è®¾è®¡

- âœ… **é«˜çº§ç‰¹æ€§** (v0.4.0) - **å·²å®Œæˆ**
  - [x] æµå¼æ‰§è¡Œæ”¯æŒï¼ˆå®æ—¶å“åº”ã€æ€è€ƒå†…å®¹ã€å·¥å…·è°ƒç”¨çŠ¶æ€ï¼‰
  - [x] æµå¼æƒé™ç¡®è®¤ï¼ˆæ”¯æŒå¤šæ¬¡ä¸­æ–­å¤„ç†ï¼‰
  - [x] å¯è§‚æµ‹æ€§æŒ‡æ ‡ç³»ç»Ÿï¼ˆExecutionMetricsï¼šTokenä½¿ç”¨ã€å·¥å…·è°ƒç”¨ã€æ‰§è¡Œè€—æ—¶ï¼‰
  - [ ] é”™è¯¯å¤„ç†å’Œè‡ªåŠ¨æ¢å¤
  - [ ] æ€§èƒ½ä¼˜åŒ–

- âœ… **APIæ¥å£** (v0.5.0) - **å·²å®Œæˆ**
  - [x] FastAPI REST æ¥å£ï¼ˆå¯¹è¯ç®¡ç†ã€Artifactç®¡ç†ï¼‰
  - [x] SSE æµå¼ä¼ è¾“ï¼ˆå®æ—¶æ¨é€æ‰§è¡Œè¿‡ç¨‹ï¼‰
  - [x] ä¾èµ–æ³¨å…¥è®¾è®¡ï¼ˆè¯·æ±‚çº§åˆ« session éš”ç¦»ï¼‰
  - [x] StreamManager äº‹ä»¶ç¼“å†²é˜Ÿåˆ—ï¼ˆTTL æœºåˆ¶ï¼‰
  - [x] OpenAPI è‡ªåŠ¨æ–‡æ¡£ï¼ˆè®¿é—® /docsï¼‰
  - [x] CLI å‘½ä»¤è¡Œå·¥å…·ï¼ˆTyper + Richï¼‰
  - [ ] å‰ç«¯ç•Œé¢é›†æˆ

- ğŸ‰ **ç”Ÿäº§å°±ç»ª** (v1.0.0) - **ç›®æ ‡**
  - [ ] å®Œæ•´çš„é”™è¯¯å¤„ç†
  - [ ] ç”Ÿäº§çº§æ€§èƒ½ä¼˜åŒ–
  - [ ] PostgreSQL è¿ç§»æ”¯æŒ
  - [ ] å®‰å…¨å¢å¼º
  - [ ] å®Œæ•´æ–‡æ¡£å’Œç¤ºä¾‹
  - [ ] Dockeréƒ¨ç½²æ”¯æŒ


## ğŸ“ æ”¯æŒä¸åé¦ˆ

- ğŸ› [é—®é¢˜åé¦ˆ](https://github.com/Neutrino1998/artifact-flow/issues)
- ğŸ’¬ [è®¨è®ºäº¤æµ](https://github.com/Neutrino1998/artifact-flow/discussions)
- ğŸ“– [å¼€å‘æ–‡æ¡£](docs/)
- ğŸ“« [è”ç³»ä½œè€…](mailto:1998neutrino@gmail.com)

